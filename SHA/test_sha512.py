import pytest
from sha512 import *
from common import string_to_bytes

def test_pad_msg():
    msg = [0xde, 0xad, 0xbe, 0xef]
    res = pad_msg(msg)
    assert res == [0xde, 0xad, 0xbe, 0xef,
                   0x80, 0x00, 0x00, 0x00,0x00, 0x00, 0x00, 0x00,0x00, 0x00, 0x00, 0x00,0x00, 0x00, 0x00, 0x00,
                   0x00, 0x00, 0x00, 0x00,0x00, 0x00, 0x00, 0x00,0x00, 0x00, 0x00, 0x00,0x00, 0x00, 0x00, 0x00,
                   0x00, 0x00, 0x00, 0x00,0x00, 0x00, 0x00, 0x00,0x00, 0x00, 0x00, 0x00,0x00, 0x00, 0x00, 0x00,
                   0x00, 0x00, 0x00, 0x00,0x00, 0x00, 0x00, 0x00,0x00, 0x00, 0x00, 0x00,0x00, 0x00, 0x00, 0x00,
                   0x00, 0x00, 0x00, 0x00,0x00, 0x00, 0x00, 0x00,0x00, 0x00, 0x00, 0x00,0x00, 0x00, 0x00, 0x00,
                   0x00, 0x00, 0x00, 0x00,0x00, 0x00, 0x00, 0x00,0x00, 0x00, 0x00, 0x00,0x00, 0x00, 0x00, 0x00,
                   0x00, 0x00, 0x00, 0x00,0x00, 0x00, 0x00, 0x00,0x00, 0x00, 0x00, 0x00,
                   0x00, 0x00, 0x00, 0x00,0x00, 0x00, 0x00, 0x00,0x00, 0x00, 0x00, 0x00,0x00, 0x00, 0x00, 0x20]

def test_sha512():
    msg = string_to_bytes("abc")
    h = sha512(msg)
    assert h == 0xddaf35a193617abacc417349ae20413112e6fa4e89a97ea20a9eeee64b55d39a2192992a274fc1a836ba3c23a3feebbd454d4423643ce80e2a9ac94fa54ca49f

    # 1024 bit message
    msg = string_to_bytes("9l5mXBb7Lprxjzb62CEvl2rBWGoFa5dmE45TmMFPQyjgM4wgZy2rmAK51sSCAAzcw5bw1S4k5MG8PZJr1lr6ZPdjPIzhHZnH79qvLcbBPFbkgF8l1HCL9FNKQMJ8aqyl")
    h = sha512(msg)
    assert h == 0xef65c3fed01be9908443efaba01da3ab837fb835441b720ce239fa51106392b71516bb1f76769e15622f252a81cb001799d51634bf43de6d61079d5e90324046

